{"posts":[{"title":"在 Android 6.0 + 实现动态申请权限","content":"在AndroidManifest.xml定义所需权限&lt;uses-permissionandroid:name=&quot;android.permission.ACCESS_WIFI_STATE&quot;/&gt;&lt;uses-permissionandroid:name=&quot;android.permission.CHANGE_WIFI_STATE&quot;/&gt;&lt;uses-permissionandroid:name=&quot;android.permission.ACCESS_COARSE_LOCATION&quot;/&gt;&lt;uses-permissionandroid:name=&quot;android.permission.ACCESS_FINE_LOCATION&quot;/&gt;然后在启动Activity创建变量，其中字符串数组内为需要的所有权限privatestaticfinalString[]REQUEST_PERMISSIONS={Manifest.permission.ACCESS_WIFI_STATE,Manifest.permission.CHANGE_WIFI_STATE,Manifest.permission.ACCESS_COARSE_LOCATION,Manifest.permission.ACCESS_FINE_LOCATION};privatestaticfinalintREQUEST_PERMISSIONS_CODE=1;请求权限privatevoidgetRequestPermission(){if(Build.VERSION.SDK_INT&gt;=Build.VERSION_CODES.M){ActivityCompat.requestPermissions(MainActivity.this,REQUEST_PERMISSIONS,REQUEST_PERMISSIONS_CODE);}}//API是否高于Android6.0（需要动态申请）@OverridepublicvoidonRequestPermissionsResult(intrequestCode,@NonNullString[]permissions,@NonNullint[]grantResults){super.onRequestPermissionsResult(requestCode,permissions,grantResults);switch(requestCode){caseREQUEST_PERMISSIONS_CODE://第一次权限请求失败if(grantResults.length==REQUEST_PERMISSIONS.length){for(intresult:grantResults){if(result!=PackageManager.PERMISSION_GRANTED){//弹出对话框引导设置showDialog();Toast.makeText(MainActivity.this,&quot;请求权限被拒绝&quot;,Toast.LENGTH_LONG).show();break;}}}else{Toast.makeText(MainActivity.this,&quot;已授权&quot;,Toast.LENGTH_LONG).show();}break;}}//第一次弹出申请privatevoidshowDialog(){AlertDialogdialog=newAlertDialog.Builder(this).setMessage(&quot;未授予本程序运行所需的权限，请去设置内授予&quot;).setPositiveButton(&quot;好&quot;,newDialogInterface.OnClickListener(){@OverridepublicvoidonClick(DialogInterfacedialog,intwhich){dialog.dismiss();goToAppSetting();}}).setNegativeButton(&quot;取消&quot;,newDialogInterface.OnClickListener(){@OverridepublicvoidonClick(DialogInterfacedialog,intwhich){dialog.dismiss();}}).setCancelable(false).show();}//如果第一次申请失败privatevoidgoToAppSetting(){Intentintent=newIntent();intent.setAction(Settings.ACTION_APPLICATION_DETAILS_SETTINGS);Uriuri=Uri.fromParts(&quot;package&quot;,getPackageName(),null);intent.setData(uri);startActivity(intent);}//跳转到当前应用的设置界面（手工给予）最后在setContentView()后面调用getRequestPermission()即可@OverrideprotectedvoidonCreate(BundlesavedInstanceState){super.onCreate(savedInstanceState);setContentView(R.layout.first_activity);//获取需要的权限getRequestPermission();}","link":"https://azwhikaru.github.io/-Iv7hAbF0/"}]}